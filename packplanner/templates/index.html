<!DOCTYPE html>
 <html>
  <head>
    <meta charset="utf-8">

    <title>GR4 Contents</title>
   
    <link href="{{STATIC_URL}}css/bootstrap.css" rel="stylesheet">
    <link href="{{STATIC_URL}}css/calendar.css" rel="stylesheet">
    <link href="{{STATIC_URL}}css/bootstrap-responsive.css" rel="stylesheet">
    <link href="{{STATIC_URL}}css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link href="{{STATIC_URL}}css/jquery-ui-1.10.2.smoothness.css" rel="stylesheet"/></link>

    <script src="{{STATIC_URL}}js/jquery-1.8.1.min.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}js/jquery-ui.js"></script>
    <script src="{{STATIC_URL}}js/bootstrap.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>

    {% block extrahead %}
    {% endblock %}

    <script type="text/javascript">
    $(function(){
    {% block jquery %}
    {% endblock %}
    });
    </script>

    <!-- Javascript Code -->
    <script type="text/javascript"> 

      function Event(id, title, location, startDate, endDate, driverTo, driverFrom, going) {
        this.id = id;
        this.title = title;
        this.location = location;
        this.startDate = startDate;
        this.endDate = endDate;
        this.driverTo = driverTo;
        this.driverFrom = driverFrom;
        this.going = going;
      }

      function compareEvents(event1, event2) {
        return (event1.startDate > event2.startDate) ? 1 : ((event1.startDate > event2.startDate) ? -1 : 0);
      }

      var events = new Array();

      /*
      Filters
      */
      var booleanFilters = [];
      var childrenFilters = ["Me", "Nick", "Andy", "Barry", "Christine"];
      var helpFilters = ["All"];

      /*
      Constants
      */
      var DEFAULT_ALL_CLASS = "btn-inverse";
      var DEFAULT_FILTER_CLASS = "btn pull-left btn-custom";
      var CUSTOM_FILTER_PREFIX = "btn-custom";

      $(document).ready(function() {

        var currentDate = new Date();
        dateSelectedFunc(currentDate);

        events = new Array();
        events[0] = new Event(0, "Soccer Game vs Mockingbird", "Oxmoor Fields", new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), 14, 0, 0, 0), new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), 16, 30, 0, 0), "Me", "Me", "Andy");
        events[1] = new Event(1, "Drama Rehearsal", "Hyde Auditorium", new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), 15, 0, 0, 0), new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), 18, 0, 0, 0), "Nick", "Nick", "Barry");
        events[2] = new Event(2, "Dinner and Movie", "Springhurst", new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), 14, 30, 0, 0), new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), 18, 0, 0, 0), "Nick", "Nick", "Nick");
        
        displayEvents();

        for(i=0;i<=helpFilters.length-1;i++){
          $('#filterBtnGroup').append('<button id="allChildren" class="btn pull-left" >' + helpFilters[i] + '</button>');
        }

        for(j=0;j<=childrenFilters.length-1;j++){
          $('#filterBtnGroup').append('<button id="partialChildren" class=' + '"btn pull-left btn-custom' + j + 'd" >' + childrenFilters[j] + '</button>');
          booleanFilters[j] = 0;
        }

        $("#filterBtnGroup #partialChildren").each(function (value) {
                $(this).bind( "click", function() {
            $(this).toggleClass( CUSTOM_FILTER_PREFIX + value);
            
            if ($(this).attr('class') == DEFAULT_FILTER_CLASS + value + "d " + CUSTOM_FILTER_PREFIX + value){
              booleanFilters[value] = 1;
            }
            else{
              booleanFilters[value] = 0;
              $("#filterBtnGroup #allChildren").each(function (value) {
              if ($(this).attr('class') != "btn pull-left"){
                $(this).toggleClass( DEFAULT_ALL_CLASS );
              }
              });
            }
          });
        });

        $("#filterBtnGroup #allChildren").each(function () {
                $(this).bind( "click", function() {
            $(this).toggleClass( DEFAULT_ALL_CLASS );

            if ($(this).attr('class') == "btn pull-left" + " " + DEFAULT_ALL_CLASS){
              $("#filterBtnGroup #partialChildren").each(function (value) {

                if ($(this).attr('class') != DEFAULT_FILTER_CLASS + value + "d " + CUSTOM_FILTER_PREFIX + value){
                  $(this).toggleClass( CUSTOM_FILTER_PREFIX + value);
                  booleanFilters[value] = 1;
                }

              });
            }

            else{
              $("#filterBtnGroup #partialChildren").each(function (value) {
              if ($(this).attr('class') == DEFAULT_FILTER_CLASS + value + "d " + CUSTOM_FILTER_PREFIX + value){
                $(this).toggleClass( CUSTOM_FILTER_PREFIX + value);
                booleanFilters[value] = 0;
              }
            });
            }

          });
              });


        $("#datepicker").datepicker({
            onSelect: function(dateText, inst) { 
              var dateAsString = dateText; //the first parameter of this function
              var dateAsObject = $(this).datepicker( 'getDate' ); //the getDate method
              dateSelectedFunc(dateAsObject);

           }
        });

        /*Previous button*/
          $("#previousDayButton").click(function() {
            var date = new Date($("#datepicker").datepicker('getDate'));
            date.setDate(date.getDate()-1);
            $("#datepicker").datepicker('setDate', date);

            prevDayFunc(date);
            dateSelectedFunc(date);

          });

          /*Next Day button*/
          $("#nextDayButton").click(function() {
            var date = new Date($("#datepicker").datepicker('getDate'));
            date.setDate(date.getDate()+1);
            $("#datepicker").datepicker('setDate', date);

            nextDayFunc(date);
            dateSelectedFunc(date);

          });

          /*Previous Week button*/
          $("#previousWeekButton").click(function() {
            var date = new Date($("#datepicker").datepicker('getDate'));
            date.setDate(date.getDate()-7);
            $("#datepicker").datepicker('setDate', date);

            prevWeekFunc(date);
            dateSelectedFunc(date);

          });

          /*Next Week button*/
          $("#nextWeekButton").click(function() {
            var date = new Date($("#datepicker").datepicker('getDate'));
            date.setDate(date.getDate()+7);
            $("#datepicker").datepicker('setDate', date);

            nextWeekFunc(date);
            dateSelectedFunc(date);

          });

          /*New Event button*/
          $("#newEventButton").click(function() {
            newEventFunc();
          });

          $('#startTime').datetimepicker({
          pickDate: false,
          pick12HourFormat: true,
          pickSeconds: false,
        });
        $('#endTime').datetimepicker({
          pickDate: false,
          pick12HourFormat: true,
          pickSeconds: false,
        });
        $('#eventDate').datetimepicker({
          pickTime: false
        });
        $("#drivingTo").typeahead({source:availDrivers,items:4});
        $("#drivingFrom").typeahead({source:availDrivers,items:4});
      });

      /*
      Functions for modularity
      */

      /*
      Returns list of selected names
      */
      function getSelectedFilters(){
        var selectedFilters = [];
        for( k=0; k<=booleanFilters.length-1; k++){
          if (booleanFilters[k] == true){
            selectedFilters.push(childrenFilters[k]);
          } 
        }
        return selectedFilters;
      }

      function dateSelectedFunc(date){
        currentDate = date;
        focusEventCalendar(currentDate);
        events = getEvents(currentDate);
        displayEvents();
        console.log(currentDate);
      }

        /*New Event button*/
        //$("#newEventButton").click(function() {
        //  $('#newEventModal').modal('');
        //});
      

      /*
      Functions for modularity
      */

      /*
      Returns list of selected names
      */
      function getSelectedFilters(){
        var selectedFilters = [];
        for( k=0; k<=booleanFilters.length-1; k++){
          if (booleanFilters[k] == true){
            selectedFilters.push(childrenFilters[k]);
          }
        }
      } 

      function focusEventCalendar(currentDate) {
        var day = currentDate.getDay();
        var firstDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());
        firstDate.setDate(firstDate.getDate()-day);
        for (i=0; i < 7; i++) {
          if (i==day) {
            $("#header" + i).removeClass("unselected-day span1").addClass("selected-day span6");
            $("#header" + i).html("<h4>" + $.datepicker.formatDate('DD, MM d', currentDate) + "</h4>");
          } else {
            $("#header" + i).removeClass("selected-day span6").addClass("unselected-day span1");
            $("#header" + i).html("<p>" + $.datepicker.formatDate('D', firstDate) + "</p><p>" + firstDate.getDate() + "</p>");
          }
          firstDate.setDate(firstDate.getDate()+1);
        }
      }

      function eventDaySelected(day) {
        var currentDay = currentDate.getDay();
        var diff = currentDay - day;
        if (diff != 0) {
          currentDate.setDate(currentDate.getDate() - diff);
          $("#datepicker").datepicker('setDate', currentDate);
          dateSelectedFunc(currentDate);
        }
      }

      function prevDayFunc(date){
        console.log("prevDay pressed");
      }

      function nextDayFunc(date){
        console.log("nextDay pressed");

      }

      function prevWeekFunc(date){
        console.log("prevWeek pressed");

      }

      function nextWeekFunc(date){
        console.log("nextWeek pressed");

      }

      function newEventFunc(){
        console.log("newEvent pressed");
        console.log(booleanFilters);
      }
      
      //javascript code for selecting drivers
      var availDrivers = ["Me","Nick","Bob","Cheryl","Mindy","George","Ari","Alessandro","Alexandra","Alex"];

      function makeList(list){
        var start = "<ul>"
        var body = ""
        var end = "</ul>"
        for(x in list){
          body = body + "<li>"+ list[x] +"</li>"
        }
        return start+body+end;
      }

      function addEvent(event) {
        events[events.length] = event;
        displayEvents();
      }

      function displayEvents() {
        events.sort(compareEvents);
        var content = $(".selected-day");
        for (i=0; i<events.length; i++) {
          var event = events[i];
          content.append("<p>" + event.title + "</p>");
        }
      }

      function getEvents(date) {
        return events;
      }
    </script>
    <!-- -->
  </head>
  <body>
    <div class="container-fluid">
      <div class="navbar">
        <div class="navbar-inner">
            <a class="brand" href="#">Pack Planner</a>
            <ul class="nav">
                <li class="active"><a href="#">Calendar</a></li>
              <li><a href="#">Contacts</a></li>
              <li><a href="#">Inbox</a></li>
              <li><a href="#">Schedules</a></li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="#">Settings</a></li>
                <li><a href="#">Logout</a></li>
            </ul>
          </div>
      </div>
    </div>

 
    <div class="container">
    <!-- Middle -->
      <div class="row">
        <div class="span4">
          <div id="datepicker"></div>
        </div>

        <div class="span8">
          <div class="row" style="height:169px">
            <div class="span8 pull-left">
              <div id="filterBtnGroup" class="btn-group row pull-left">
                <!-- Fill in children group filter dynamically -->
              </div>
            </div>

            <div class="span4 pull-right">
              <div class="row pull-right">
                <a id="newEventButton" class="btn btn-success pull-right" data-toggle="modal" href="#newEventModal" ><i class="icon-plus"></i> New Event</a>

                <!-- newEventModal -->
                <div id="newEventModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h3 id="myModalLabel">New Event</h3>
                  </div>
                  <div class="modal-body">
                    <form>
                      <div class="row-fluid">
                        <div class="span12">    
                          <div class="row-fluid">   
                            <div class="span5 lightblue">
                              <label>Event Name</label>
                              <input type="text" class="span12" placeholder="Event Name">
                            </div><!--/span-->
                            <div id="eventDate" class="span5 offset1 lightblue input-append">
                              <label>Event Date</label>
                              <input data-format="MM-dd-yyyy" type="text" placeholder="11-28-2013" class="span12"></input>
                              <span class="add-on">
                                <i data-time-icon="icon-time" data-date-icon="icon-calendar">
                                </i>
                              </span>
                            </div><!--/span-->
                          </div><!--/row-->
                          <div class="row-fluid">
                            <div id= "startTime" class="span5 bgcolor input-append">
                              <label>Start Time</label>
                              <input id="startTimeInput"class="span12" placeholder="15:30:00" data-format="hh:mm:ss" type="text"></input>
                              <span class="add-on">
                                <i data-time-icon="icon-time" data-date-icon="icon-calendar">
                                </i>
                              </span>  
                            </div><!--/span-->
                            <div id= "endTime" class="span5 offset1 bgcolor input-append">
                              <label>End Time</label>
                              <input class="span12" placeholder="17:30:00" data-format="hh:mm:ss" type="text"></input>
                              <span class="add-on">
                                <i data-time-icon="icon-time" data-date-icon="icon-calendar">
                                </i>
                              </span>  
                            </div><!--/span-->
                          </div><!--/row-->
                          <div class="row-fluid" style="padding-bottom:100px">
                            <div class="span5 bgcolor input-append">
                              <label>Driving To (optional):</label>
                              <input id= "drivingTo" autocomplete="off" type="text" data-provide="typeahead"></input>
                                
                            </div><!--/span-->
                            <div class="span5 offset1 bgcolor input-append">
                              <label>Driving From (optional):</label>
                              <input id= "drivingFrom" autocomplete="off" type="text" data-provide="typeahead"></input>
                              
                            </div><!--/span-->
                          </div><!--/row-->
                          <div class="row">
                          </div>               
                        </div>     
                      </div><!--/row-->
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                    <button class="btn btn-primary">Save changes</button>
                  </div>
                </div><!--end modal -->
              </div>
            </div>
          </div>
          <div class="row">
            <div class ="span2 pull-left">
              <div class="btn-group row pull-left">
                <a id="previousDayButton" class="btn" href="#"><i class="icon-chevron-left"></i> Prev Day</a>
                <a id="nextDayButton" class="btn" href="#">Next Day <i class="icon-chevron-right"></i></a>

              </div>
            </div>

            <div class="span2 pull-right">
              <div class="btn-group row pull-right">

                <a id="previousWeekButton" class="btn " href="#"><i class="icon-chevron-left"></i> Prev Week</a>
                <a id="nextWeekButton" class="btn " href="#">Next Week <i class="icon-chevron-right"></i></a>

              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="row spacer">
        <div id="header0" class="span1 unselected-day first-day" onClick="eventDaySelected(0);">Sunday</div>
        <div id="header1" class="span1 unselected-day" onClick="eventDaySelected(1);">Monday</div>
        <div id="header2" class="span1 unselected-day" onClick="eventDaySelected(2);">Tuesday</div>
        <div id="header3" class="span1 unselected-day" onClick="eventDaySelected(3);">Wednesday</div>
        <div id="header4" class="span1 unselected-day" onClick="eventDaySelected(4);">Thursday</div>
        <div id="header5" class="span1 unselected-day" onClick="eventDaySelected(5);">Friday</div>
        <div id="header6" class="span6 selected-day last-day" onClick="eventDaySelected(6);">Saturday</div>
      </div>
    </div>
  </body>
</html>
